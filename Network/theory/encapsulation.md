## Encapsulation

- 애플리케이션에서 만든 데이터를 데이터 플로 계층으로 내려보내면서 패킷에 데이터를 넣을 수 있도록 분할하는 과정
- 네트워크 상황을 고려해 적절한 크기로 데이터를 쪼개고 4계층, 3계층 그리고 2계층 순서로 네트워크 전송을 위한 정보를 헤더에 붙여 넣는다.
- 2계층까지 네트워크 전송에 필요한 정보를 헤더에 넣었다면 전기 신호로 변환해 수신자에게 전공한다.

<br>

## Decapsulation

- 받은 전기 신호를 데이터 형태로 만들어 2계층으로 올립니다.
- 2계층에서는 송신자가 작성한 2계층 헤더에 포함된 정보를 확인합니다.
- 만약 목적지 MAC 주소와 자신의 MAC 주소가 같다면 데이터를 처리해야하고, 그렇지 않을 경우 패킷을 버린다.
- 2계층 헤더 정보를 벗겨내고 3계층에 올려보내며 3계층과 4계층도 같은 방식으로 동작한다.
- 패킷들을 조합해 데이터 형태로 만든다.

<br>

## 헤더

- Encapsulation 과정에서 2, 3, 4계층에서는 다음과 같은 정보를 추가한다.
- 현재 계층에서 정의하는 정보와 상위 프로토콜 지시자
- 4계층 TCP에서는 데이터 전송 보장으로 위해 Sequence, Aacknowledgement 번호 필드로 데이터를 표현한다.
- 디캡슐레이션 하는 과정에서는 3계층에서 4계층으로 올리기 위해 TCP, UDP 프로토콜 중 송신자가 설정한 프로토콜로 보낸다.
- 즉, 계층마다 어떤 프로토콜로 올려보낼 것인지를 정하기 위해 인캡슐레이션 과정에서 상위 프로토콜 지시자의 정보를 저장한다.
- 상위 프로토콜 정보를 저장하므로 4계층에서는 Application 계층에서 사용할 포트번호를, 3계층에서는 4계층의 프로토콜을 설정한다.